<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒ©ãƒ¼ãƒ¡ãƒ³ç®¡ç†</title>
<style>
body{font-family:sans-serif;background:#f4f4f4;padding:20px}
.card{background:#fff;padding:15px;border-radius:10px;margin-bottom:15px}
.hidden{display:none}
button{padding:6px 10px;border:none;border-radius:6px;cursor:pointer}
.save{background:#4caf50;color:#fff}
.edit{background:#2196f3;color:#fff}
.delete{background:#f44336;color:#fff}
.history{border-bottom:1px solid #ddd;padding:8px 0}
</style>
</head>
<body>

<h1>ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³ç®¡ç†</h1>

<div class="card">
<select id="type">
  <option value="jiro">äºŒéƒç³»</option>
  <option value="iekei">å®¶ç³»</option>
  <option value="shachirin">é¯±è¼ª</option>
  <option value="other">ãã®ä»–</option>
</select>

<!-- äºŒéƒç³» -->
<div id="jiroBox">
  <input id="jiroShop" placeholder="åº—å"><br>
  éººé‡ï¼š
  <select id="jiroNoodle"></select><br>
  ãƒ¤ã‚µã‚¤ï¼š
  <select id="jiroVeg">
    <option>ãã®ã¾ã¾</option><option>ãƒã‚·</option><option>ãƒã‚·ãƒã‚·</option>
  </select>
  ã‚¢ãƒ–ãƒ©ï¼š
  <select id="jiroOil">
    <option>ãã®ã¾ã¾</option><option>ãƒã‚·</option><option>ãƒã‚·ãƒã‚·</option>
  </select>
</div>

<!-- å®¶ç³» -->
<div id="iekeiBox" class="hidden">
  <input id="iekeiShop" placeholder="åº—å"><br>
  ã‚µã‚¤ã‚ºï¼š
  <select id="iekeiSize">
    <option value="0">æ™®é€š</option>
    <option value="150">å¤§ç››</option>
  </select>
  ãƒ©ã‚¤ã‚¹ï¼š
  <input type="number" id="riceCount" min="0" max="10" value="0"> æ¯
</div>

<!-- é¯±è¼ª -->
<div id="shachiBox" class="hidden">
  <select id="shachiMenu">
    <option value="900">èµ¤ã¾ãœãã°</option>
    <option value="950">æ—¨è¾›ã«ã‚“ã«ãã‚‰ãƒ¼ã‚ã‚“</option>
  </select><br>
  <label><input type="checkbox" id="cheese">ãƒãƒ¼ã‚º</label>
  <label><input type="checkbox" id="oomori">å¤§ç››</label>
  <label><input type="checkbox" id="chashu">ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼</label>
  <label><input type="checkbox" id="shachiRice">ãƒ©ã‚¤ã‚¹</label>
</div>

<!-- ãã®ä»– -->
<div id="otherBox" class="hidden">
  <input id="otherMemo" placeholder="ãƒ¡ãƒ¢">
</div>

<br>
<button class="save" id="saveBtn">ä¿å­˜</button>
</div>

<div class="card">
<h2>ğŸ“œ å±¥æ­´ï¼ˆã¾ã¨ã‚è¡¨ç¤ºï¼‰</h2>
<div id="history"></div>
</div>

<script>
/* åˆæœŸåŒ– */
const noodleSel=document.getElementById("jiroNoodle");
for(let i=100;i<=500;i+=50) noodleSel.innerHTML+=`<option>${i}</option>`;

const boxes={jiro:jiroBox,iekei:iekeiBox,shachirin:shachiBox,other:otherBox};
type.onchange=()=>{
  Object.values(boxes).forEach(b=>b.classList.add("hidden"));
  boxes[type.value].classList.remove("hidden");
};

/* ãƒ‡ãƒ¼ã‚¿ */
let logs=JSON.parse(localStorage.getItem("ramenLog")||"[]");
let editIndex=null;

/* ã‚«ãƒ­ãƒªãƒ¼è¨ˆç®— */
function calc(e){
  if(e.type==="jiro"){
    let c=e.noodle*3;
    if(e.veg==="ãƒã‚·")c+=50;
    if(e.veg==="ãƒã‚·ãƒã‚·")c+=100;
    if(e.oil==="ãƒã‚·")c+=80;
    if(e.oil==="ãƒã‚·ãƒã‚·")c+=160;
    return c;
  }
  if(e.type==="iekei"){
    return 700+Number(e.size)+e.rice*250;
  }
  if(e.type==="shachirin"){
    return Number(e.menu)
      +(e.cheese?100:0)+(e.oomori?150:0)
      +(e.chashu?200:0)+(e.rice?250:0);
  }
  return 0;
}

/* ä¿å­˜ */
saveBtn.onclick=()=>{
  let e={type:type.value,time:new Date().toLocaleString()};
  if(e.type==="jiro"){
    e.shop=jiroShop.value;
    e.noodle=Number(jiroNoodle.value);
    e.veg=jiroVeg.value;
    e.oil=jiroOil.value;
  }
  if(e.type==="iekei"){
    e.shop=iekeiShop.value;
    e.size=iekeiSize.value;
    e.rice=Number(riceCount.value);
  }
  if(e.type==="shachirin"){
    e.menu=shachiMenu.value;
    e.cheese=cheese.checked;
    e.oomori=oomori.checked;
    e.chashu=chashu.checked;
    e.rice=shachiRice.checked;
  }
  if(e.type==="other") e.memo=otherMemo.value;

  e.cal=calc(e);

  if(editIndex!==null){logs[editIndex]=e;editIndex=null;}
  else logs.push(e);

  localStorage.setItem("ramenLog",JSON.stringify(logs));
  render();
};

/* è¡¨ç¤º */
function render(){
  history.innerHTML="";
  logs.forEach((l,i)=>{
    history.innerHTML+=`
    <div class="history">
      ${l.time}ï½œ${l.type}ï½œ${l.shop||l.memo||""}<br>
      <b>${l.cal} kcal</b>
      <button class="edit" onclick="edit(${i})">ç·¨é›†</button>
      <button class="delete" onclick="del(${i})">å‰Šé™¤</button>
    </div>`;
  });
}
function del(i){
  logs.splice(i,1);
  localStorage.setItem("ramenLog",JSON.stringify(logs));
  render();
}
function edit(i){
  editIndex=i;
  type.value=logs[i].type;
  type.onchange();
}
render();
</script>
</body>
</html>

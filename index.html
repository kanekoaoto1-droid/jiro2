<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ©ãƒ¼ãƒ¡ãƒ³ç®¡ç†</title>
<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  margin: 0;
  padding: 12px;
  background: #f7f7f7;
}
h1 { font-size: 20px; }
section {
  background: #fff;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 8px;
}
label { display: block; margin-top: 6px; }
button {
  margin-top: 10px;
  width: 100%;
  padding: 10px;
  font-size: 16px;
}
.record {
  border-bottom: 1px solid #ddd;
  padding: 6px 0;
}
.small { font-size: 12px; color: #555; }
.warning { color: red; font-weight: bold; }
</style>
</head>

<body>

<h1>ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³è¨˜éŒ²</h1>

<section>
<label>åº—åï¼ˆæ‰‹å…¥åŠ›ï¼‰
<input id="shop" placeholder="ä¾‹ï¼šãƒ©ãƒ¼ãƒ¡ãƒ³äºŒéƒä¸‰ç”°æœ¬åº—ã€å‰æ‘å®¶"></label>

<label>ã‚¸ãƒ£ãƒ³ãƒ«
<select id="type" onchange="updateOptions()">
<option value="jiro">äºŒéƒç³»</option>
<option value="iekei">å®¶ç³»</option>
<option value="shachirin">é¯±è¼ª</option>
</select></label>

<div id="options"></div>

<button onclick="save()">è¨˜éŒ²ã™ã‚‹</button>
</section>

<section>
<h2>ğŸ“Š å±¥æ­´</h2>
<div id="log"></div>
</section>

<script>
const logs = JSON.parse(localStorage.getItem("ramenLogs") || "[]");

function updateOptions() {
  const type = document.getElementById("type").value;
  let html = "";

  if (type === "jiro") {
    html = `
    <label>éººé‡
    <select id="men">
      <option value="300">å°‘ãªã‚</option>
      <option value="400">æ™®é€š</option>
      <option value="500">å¤§</option>
    </select></label>
    <label><input type="checkbox" id="abura"> ã‚¢ãƒ–ãƒ©</label>
    <label><input type="checkbox" id="yasai"> ãƒ¤ã‚µã‚¤</label>`;
  }

  if (type === "iekei") {
    html = `
    <label>ã‚µã‚¤ã‚º
    <select id="size">
      <option value="700">æ™®é€š</option>
      <option value="850">å¤§ç››</option>
    </select></label>
    <label>ãƒ©ã‚¤ã‚¹æ¯æ•°
    <input type="number" id="rice" value="0" min="0"></label>`;
  }

  if (type === "shachirin") {
    html = `
    <label>ãƒ¡ãƒ‹ãƒ¥ãƒ¼
    <select id="menu">
      <option value="800">æ—¨è¾›ã«ã‚“ã«ããƒ©ãƒ¼ãƒ¡ãƒ³</option>
      <option value="850">èµ¤ã¾ãœãã°</option>
    </select></label>
    <label><input type="checkbox" id="big"> å¤§ç››</label>
    <label><input type="checkbox" id="cheese"> ãƒãƒ¼ã‚º</label>
    <label><input type="checkbox" id="chashu"> ãƒãƒ£ãƒ¼ã‚·ãƒ¥ãƒ¼</label>
    <label><input type="checkbox" id="rice2"> ãƒ©ã‚¤ã‚¹</label>`;
  }

  document.getElementById("options").innerHTML = html;
}

function save() {
  const shop = document.getElementById("shop").value || "æœªè¨˜å…¥";
  const type = document.getElementById("type").value;
  let cal = 0;
  let detail = "";

  if (type === "jiro") {
    cal += Number(document.getElementById("men").value);
    if (abura.checked) cal += 100;
    if (yasai.checked) cal += 50;
    detail = "äºŒéƒç³»";
  }

  if (type === "iekei") {
    cal += Number(document.getElementById("size").value);
    cal += Number(document.getElementById("rice").value) * 250;
    detail = "å®¶ç³»";
  }

  if (type === "shachirin") {
    cal += Number(document.getElementById("menu").value);
    if (big.checked) cal += 150;
    if (cheese.checked) cal += 120;
    if (chashu.checked) cal += 200;
    if (rice2.checked) cal += 250;
    detail = "é¯±è¼ª";
  }

  logs.push({
    date: new Date().toISOString().slice(0,10),
    shop, detail, cal
  });

  localStorage.setItem("ramenLogs", JSON.stringify(logs));
  render();
}

function render() {
  const area = document.getElementById("log");
  area.innerHTML = "";
  const last7 = logs.filter(l =>
    (new Date() - new Date(l.date)) / 86400000 < 7
  );

  if (last7.length >= 2) {
    area.innerHTML += `<div class="warning">âš  ä»Šé€±ãƒ©ãƒ¼ãƒ¡ãƒ³å¤šããªã„ï¼Ÿ</div>`;
  }

  logs.slice().reverse().forEach(l => {
    area.innerHTML += `
    <div class="record">
      <b>${l.shop}</b> (${l.detail})<br>
      ${l.cal} kcal<br>
      <span class="small">${l.date}</span>
    </div>`;
  });
}

updateOptions();
render();
</script>

</body>
</html>
